<!DOCTYPE html>
<html lang="en">
    <head>
        <title>VectorFormats :: Documentation</title>
        <!-- Bootstrap -->
        <link href="assets/css/bootstrap.css" rel="stylesheet"></link>
        <link href="assets/css/bootstrap-responsive.css" rel="stylesheet"></link>
        <link href="assets/css/docs.css" rel="stylesheet"></link>
        <link href="assets/css/prettify.css" rel="stylesheet"></link>
        <link href="assets/css/application.css" rel="stylesheet"></link>
        
        <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
         <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
         <![endif]-->
        
        <script src="assets/js/jquery.js"></script>
        <script src="assets/js/bootstrap.js"></script>
        <script src="assets/js/prettify.js"></script>
        <script src="assets/js/application.js" type="text/javascript" charset="utf-8"></script>
        
    </head>
    <body data-spy="scroll" data-target=".bs-docs-sidebar">
        
        <!-- Navigation
         ================================================== -->
        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <div class="nav-collapse">
                        <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="brand" href="vectorformats.html">VectorFormats</a>
                        <ul class="nav">
                            <li><a href="vectorformats.html">Home</a></li>
                            <li><a href="vectorformats_overview.html">Overview</a></li>
                            <li class="active"><a href="#">Documentation</a></li>
                            <li><a href="vectorformats_download.html">Source &amp; Download</a></li>
                            <li class="divider-vertical"></li>
                            <li><a href="index.html">FeatureServer</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        
        
        <!-- Subhead
         ================================================== -->
        <header class="jumbotron subhead" id="overview">
            <div class="container">
                <header>
                    <h1>Documentation</h1>
                </header>
                <p class="lead">VectorFormats is installed ... and now ...</p>
            </div>
        </header>
        
        <div class="container" id="api">
            <div class="row">
                <div class="span3 bs-docs-sidebar">
                    <ul class="nav nav-list bs-docs-sidenav affix-top" data-spy="affix" data-target=".bs-docs-sidebar">
                        <li class="nav-header">Installation</li>
                        <li><a href="#doc-inst-installation"><i class="icon-chevron-right"></i> Installation</a></li>
                        <li><a href="#doc-inst-dependencies"><i class="icon-chevron-right"></i> Dependencies</a></li>
                        <li class="nav-header">API</li>
                        <li><a href="#doc-api-usage"><i class="icon-chevron-right"></i> Usage</a></li>
                        <li><a href="#doc-api-ext"><i class="icon-chevron-right"></i> Extending</a></li>
                        <li class="nav-header">Interface</li>
                        <li><a href="#doc-if-format"><i class="icon-chevron-right"></i> Format</a></li>
                        <li><a href="#doc-if-feature"><i class="icon-chevron-right"></i> Feature</a></li>
                    </ul>
                </div>
                
                <div class="span9">
                    <!-- Installation: Installation
                     ================================================== -->
                    <section id="doc-inst-installation">
                        <header>
                            <h2>Installation <small>(installation)</small></h2>
                            <h3>PIP <small>(installation --&gt; installation)</small></h3>
                        </header>
                        <p>This project is listed in the <a href="http://pypi.python.org/" target="_new">Python Package Index</a> under the project id <a href="http://pypi.python.org/pypi/vectorformats" target="_new">vectorformats</a>. You can install this libraray using pip as follow:
                        <pre class="prettyprint">pip install vectorformats</pre></p>
                        
                        <header>
                            <h3>Manual <small>(installation --&gt; installation)</small></h3>
                        </header>
                        <p>An other way is to download the latest version from the <a href="/vectorformats_download.html">download section</a> and using the provided installation script:
                        <pre class="prettyprint">python setup.py install</pre></p>
                    </section>
                    
                    <!-- Installation: Dependencies
                     ================================================== -->
                    <section id="doc-inst-dependencies">
                        <header>
                            <h2>Dependencies <small>(installation)</small></h2>
                        </header>
                        <p>It depence on:
                            <ul>
                                <li>dxfwrite >= 1.2.0</li>
                                <li>pyshp >= 1.1.4</li>
                                <li>pyspatialite >= 3.0.1<br/>
                                    <div class="bs-docs-frame bs-docs-frame-comment">
                                        <code class="prettyprint">setup.py</code> in version 3.0.1 raises an error when trying to download <code class="prettyprint">libspatialite-amalgamation.*</code>. Download <code class="prettyprint">pyspatialite</code> from PyPi and change the following lines in <code class="prettyprint">setup.py</code>:
                                        <pre class="prettyprint linenums">
    # find out what's current amalgamation ZIP file
-    download_page = urllib.urlopen("https://www.gaia-gis.it/fossil/libspatialite/index").read()
+    download_page = urllib.urlopen("http://www.gaia-gis.it/gaia-sins/libspatialite-sources/").read()
    pattern = re.compile("(libspatialite-amalgamation.*?\.zip)")
-    download_file = pattern.findall(download_page)[0]
-    amalgamation_url = "http://www.gaia-gis.it/gaia-sins/" + download_file
+    download_file = pattern.findall(download_page)[-1]
+    amalgamation_url = "http://www.gaia-gis.it/gaia-sins/libspatialite-sources/" + download_file
    zip_dir = string.replace(download_file,'.zip','')
    # and download it
    urllib.urlretrieve(amalgamation_url, "tmp.zip")</pre>
                                    </div>

                                </li>
                            </ul>
                        </p>
                    </section>
                    

                    
                
                    <!-- API: Usage
                     ================================================== -->
                    <section id="doc-api-usage">
                        <header>
                            <h2>Usage <small>(API)</small></h2>
                        </header>
                        <p>All supported vector formats listed in the <a href="/vectorformats_overview.html">overview section</a> can be instantiated by importing the right package and clases. In the following explenations we use the CSV vector format as an example.</p>
                        
                        <p>First of all we need to import the Python class as follow:
                        <pre class="prettyprint">from vectorformats.formats.csv import CSV</pre><p>
                        
                        <p>Next step is to create a new <code class="prettyprint">Feature</code> instance, which will be decocded afterwards. Import the feature definition
                        <pre class="prettyprint">import vectorformats.feature import Feature</pre>
                        and create a new <code class="prettyprint">Feature</code> object
                        <pre class="prettyprint">feat = Feature(1, {"type":"Point", "coordinates":[1,1]}, {"a":"b"})</pre></p>
                        
                        <p>Now a new vector format can be instantiated an decoded to the corresponding format like
                        <pre class="prettyprint">c = CSV()
print c.encode([feat])</pre></p>
                    </section>
                
                    <!-- API: Extending
                     ================================================== -->
                    <section id="doc-api-ext">
                        <header>
                            <h2>Extending <small>(API)</small></h2>
                        </header>
                        <p>It is possbile to extend the vector format library by adding a new format (Source code can be downloaded <a href="/vectorformats_download.html">here</a>). All new formats need to extend from the class <code class="prettyprint">Format</code> located in the package <code class="prettyprint">vectorformats.format</code>.</p>
                        
                        <p>For encoding a <code class="prettyprint">Feature</code> object to the new format then you need to overwrite the <code class="prettyprint">encode</code> method, which gets a list of features</code></p>
                        
                        <p> To decode a feature from the new  format to the <code class="prettyprint">Feature</code> object, the method <code class="prettyprint">decode</code> method does it by getting a data object. The type of the data object is defined by the new format object itself</p>
                        
                        <p>An example could look like this:
                        <pre class="prettyprint linenums">from ..feature import Feature
from .format import Format
import StringIO

class MyFormat (Format):
    
    def encode(self, features, **kwargs):
        s = StringIO.StringIO()
        for feature in features:
            ''' do something '''
        return s
    
    def decode(self, data, **kwargs):
        results = []
        ''' do something '''
        return results</pre></p>
                    </section>
                    
                    

                    
                    <!-- Interface: Format
                     ================================================== -->
                    <section id="doc-if-format">
                        <header>
                            <h2>Format <small>(interface)</small></h2>
                        </header>
                        <p>The <code class="prettyprint">Format</code> class is the base class which sets properties on the subclasses by passing them as <code class="prettyprint">kwargs</code> to your format constructor. In general, each new subclass need to implement the <code class="prettyprint">encode</code> and <code class="prettyprint">decode</code> methods, where the former returns a format specific object and the latter a list of <code class="prettyprint">Feature</code>.</p>
                        <p>
                        <pre class="prettyprint linenums">class Format(object):
    def __init__(self, *args, **kwargs):
        for key, value in kwargs.items():
            setattr(self, key, value)
    
    def encode(self, features, **kwargs):
        ''' returns a format specific object (e.g. StringIO)'''
        pass
    def decode(self, data, **kwargs):
        ''' returns a list of Feature '''
        pass</pre></p>
                    </section>

                    <!-- Interface: Feature
                     ================================================== -->
                    <section id="doc-if-feature">
                        <header>
                            <h2>Feature <small>(interface)</small></h2>
                        </header>
                        <p>A <code class="prettyprint">Feature</code> class represents a simple feature holding the attributes:
                            <table class="table">
                                <thead>
                                    <tr><th>attribute</th><th>description</th></tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>layer</td>
                                        <td>Name of the layer</td>
                                    </tr>
                                    <tr>
                                        <td>id</td>
                                        <td>A unique identifier</td>
                                    </tr>
                                    <tr>
                                        <td>geometry</td>
                                        <td>A dictionary holding the attributes <code  class="prettyprint">type</code> and <code  class="prettyprint">coordinates</code>. For a point it could look like this: <pre class="prettyprint">{'type':'Point', 'coordinates':[1.0,2.0]}</pre></td>
                                    </tr>
                                    <tr>
                                        <td>geometry_attr</td>
                                        <td>Name of the geometry. Is e.g. used in WFS/GML output as XML node name for the geometry coordinates.</td>
                                    </tr>
                                    <tr>
                                        <td>properties</td>
                                        <td>A dictionary of key value pairs. You can loop over it <pre class="prettyprint">for key, value in feature.properties.items():</pre></td>
                                    </tr>
                                    <tr>
                                        <td>srs</td>
                                        <td>Spatial Reference System of the feature's coordinates</td>
                                    </tr>
                                    <tr>
                                        <td>bbox</td>
                                        <td>Is automatically calculated from the geometry attribute.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </p>
                    </section>
                </div>
            </div>
        </div>
        
        
        
        <!-- Footer
         ================================================== -->
        <footer class="footer">
            <div class="container">
                <p class="pull-right"><a href="#">Back to top</a></p>
                <p>&copy; 2012 FeatureServer.org. Design by <a href="http://twitter.github.com/bootstrap/" target="_new">Twitter Bootstrap</a></p>
                <ul class="footer-links">
                    <li><a href="http://lists.osgeo.org/mailman/listinfo/featureserver" target="_new">Mailing List</a></li>
                    <li>|</li>
                    <li><a href="http://twitter.com/vector_formats" target="_new">Twitter</a></li>
                    <li>|</li>
                    <li><a href="http://github.com/iocast/vectorformats" target="_new">Source Code</a></li>
                    <li>|</li>
                    <li><a href="http://webchat.freenode.net/?channels=vectorformats" target="_new" rel="tooltip" data-placement="top" data-original-title="channel #vectorformats at irc.freenode.net">IRC</a></a></li>
                </ul>
            </div>
        </footer>
        
        
    </body>
</html>